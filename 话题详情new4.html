<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
		
		<title>C2B-话题详情</title>
		<link rel="stylesheet" type="text/css" href="common/css/common.css"/>
		<link rel="stylesheet" type="text/css" href="common/font/iconfont.css"/>
		<link rel="stylesheet" type="text/css" href="common/fontx/iconfontXi.css"/>
		<link rel="stylesheet" type="text/css" href="common/css/style.css"/>
		<script type="text/javascript" src="common/js/jquery-2.0.0.min.js">
		</script>
		<script type="text/javascript" src="common/js/base.js">
		</script>
	  
</head>
<body class="newHuaTiBody">
	<div class="header">
			<a  onclick="history.go(-1)"><span class="pubBtn goback iconfont  ai-arrow-down"> &#xe658</span></a>
			<a href="index.html"><span class="homeBtn"><img src="common/img/logo.png" alt="" /></span></a>
			大通话题
			<a href="菜单.html"><span class="pubBtn navBtn iconfont  liebiao7">&#xe64a;</span></a>
	</div>
<!--最新话题详情页面结构-->
<div class="c2bMain newHuatiMod teShuHuaTiMod">
			<h2 class="newsTit">
				 座椅布局
			</h2>
			<div class="newOther">
				<span class="time"><i class="iconfont riqi">&#xe68c;</i>2016-5-31 20:35</span>
				<span class="like"><i class="iconfont zan2">&#xe6b4;</i><em>22</em></span>
				<span class="like2"><i class="iconfont xihuan">&#xe6a3;</i>收藏</span>
				
			</div>
			<div class="newHtCont">
				<div class="picShow">
					<img src="common/img/teshu4Img.jpg" alt="" />
					
				</div>
				<div class="teShuH5GameMod">
					<div class="huaTilist">
						<div class="huaTiName">1.全家出行，您一般会让你的孩子坐在？</div>
						<div class="huaTiAnswer"><label for="test"><input id="test" type="checkbox">A.副驾驶</label></div>
						<div class="huaTiAnswer"><label for=""><input type="radio">B.第二排</label></div>
						<div class="huaTiAnswer"><label for=""><input type="radio">C.第三排</label></div>
						<div class="huaTiAnswer"><label for=""><input type="radio">D.不一定</label></div>
					</div>
					 
					<div class="huaTilist">
						<div class="huaTiName">2.全家出行，您一般会让老人坐在？</div>
						<div class="huaTiAnswer"><label for="test"><input id="test" type="radio">A.副驾驶</label></div>
						<div class="huaTiAnswer"><label for=""><input type="radio">B.第二排</label></div>
						<div class="huaTiAnswer"><label for=""><input type="radio">C.第三排</label></div>
						<div class="huaTiAnswer"><label for=""><input type="radio">D.不一定</label></div>
					</div> 
					
					<div class="huaTilist">
						<div class="huaTiName">3.如果中大型SUV将后2排座位调整到4座布局以增加乘坐空间，你是否会选择？</div>
						<div class="huaTiAnswer"><label for="test"><input id="test" type="radio">A.是</label></div>
						<div class="huaTiAnswer"><label for=""><input type="radio">B.否</label></div>
						 
					</div> 
				</div>
				<div class="h5GameMod">
					<div class="fanganName">布局随意拼    </div>
					<div class="h5GanmeCont">
						<div class='pz-box pz-set-css'>
							<div class='pz-p1 pz-set-css pz-p'></div>
							<div class='pz-p2 pz-set-css pz-p'></div>
							<div class='pz-p3 pz-set-css pz-p'></div>
							<div class='pz-p4 pz-set-css pz-p'></div>
						</div>
					</div>
				</div>
				<div class="pubBigBtn " id="debug">提交</div>
			</div>
</div>
	<div class="c2bMain">
		<div class="newsInfo huaTiInfoBox">
			 
			 
		<div class="otherXinXi">
			<dl class="share">
				<dt>分享到:</dt>
				<dd>
					<a href="" class="share-wx"><img src="common/img/weiXinIco.png" alt="" /></a>
					<a href="" class="share-weibo"><img src="common/img/weiXinPyqIco.png" alt="" /></a>
					<a href="" class="share-qq"><img src="common/img/qzoneIco.png" alt="" /></a>
					<a href="" class="share-weibo"><img src="common/img/sinaIco.png" alt="" /></a>
				</dd>
			</dl>
			<span class="like2"><i class="iconfont xihuan">&#xe6a3;</i>收藏</span>
			<span class="like"><i class="iconfont zan2">&#xe6b4;</i><em>23</em></span>
		</div>
		<div class="pingLunQuyu">
			<div class="cheader">
				<div class="dtag">文章评论</div> 
			</div>
			<div class="ceditzone ">
				<div class="cavatar iconfont  yonghu" >&#xe61e;</div>
				<div class="cbody cedit" data-node="cedit">
					<div class="ctextarea" ga_event="click_input_comment">
						<textarea class="cinput" data-node="cinput" placeholder="写下你的评论..."></textarea>
					</div>
					<div class="caction">
						
						<div class="csubmit" data-node="csubmit" ga_event="click_publish_comment">发表</div>
					</div>
				</div>
			</div>
			<div class="ulist">
				<ul class="clist">
					<li class="citem clearfix">
						<div class="cavatar">
							<a href="3" target="_blank" >
								<img src="http://p1.pstatp.com/thumb/8368/7237428081" onload="this.style.opacity=1;" style="opacity: 1;">
							</a>
						</div>
						<div class="cbody">
							<div class="cuser">
								<a class="cname" href="#" target="_blank">彭博595200</a>
							</div>
							<div class="ctxt">去年我的一张瑕疵百元币被上海摩根大通拍卖公司忽悠成错币，说值一百万，结果我抱
								着发财梦飞去上海，……最后的结局是被畜牲们骗了我两万二！钱是要不回来了，只有安慰自己就当
								给畜牲们烧了点纸钱吧。</div>
							<div class="cinfo clearfix">
								<span class="ctime">2016-06-02 16:14</span>
								<div class="c-actions">
									<span class="huifu"><i class="iconfont ai-link">&#xe61c;</i>回复</span>
									<a class="cdigg " href="javascript:;" >
										<span class="digg-num">212</span><i class="cbtn iconfont zan2">&#xe6b4;</i>
									</a>
									
									
								</div>
							</div>
						</div>
					</li>
					<li class="citem clearfix">
						<div class="cavatar">
							<a href="3" target="_blank" >
								<img src="http://p1.pstatp.com/thumb/8368/7237428081" onload="this.style.opacity=1;" style="opacity: 1;">
							</a>
						</div>
						<div class="cbody">
							<div class="cuser">
								<a class="cname" href="#" target="_blank">彭博595200</a>
							</div>
							<div class="ctxt">去年我的一张瑕疵百元币被上海摩根大通拍卖公司忽悠成错币，说值一百万，结果我抱
								着发财梦飞去上海，……最后的结局是被畜牲们骗了我两万二！钱是要不回来了，只有安慰自己就当
								给畜牲们烧了点纸钱吧。</div>
							<div class="cinfo clearfix">
								<span class="ctime">2016-06-02 16:14</span>
								<div class="c-actions">
									<a class="cdigg " href="javascript:;" >
										<span class="digg-num">212</span><i class="cbtn iconfont zan2">&#xe6b4;</i>
									</a>
									
									
								</div>
							</div>
						</div>
					</li>
					<li class="citem clearfix">
						<div class="cavatar">
							<a href="3" target="_blank" >
								<img src="http://p1.pstatp.com/thumb/8368/7237428081" onload="this.style.opacity=1;" style="opacity: 1;">
							</a>
						</div>
						<div class="cbody">
							<div class="cuser">
								<a class="cname" href="#" target="_blank">彭博595200</a>
							</div>
							<div class="ctxt">去年我的一张瑕疵百元币被上海摩根大通拍卖公司忽悠成错币，说值一百万，结果我抱
								着发财梦飞去上海，……最后的结局是被畜牲们骗了我两万二！钱是要不回来了，只有安慰自己就当
								给畜牲们烧了点纸钱吧。</div>
							<div class="cinfo clearfix">
								<span class="ctime">2016-06-02 16:14</span>
								<div class="c-actions">
									<a class="cdigg " href="javascript:;" >
										<span class="digg-num">212</span><i class="cbtn iconfont zan2">&#xe6b4;</i>
									</a>
									
									
								</div>
							</div>
						</div>
					</li>
				</ul>
				<div class="pubMore">查看更多<i class="cbtn iconfont jiantou3">&#xe659;</i></div>
			</div>
		</div>
		
		</div>
	</div>
	<script>
		(function(doc){
			var QS=function($){
				return doc.querySelector($);
			};
			var QSA=function($){
				return doc.querySelectorAll($);
			};
			var oPos=function(elt) {//离client top 的值
				var x = 0,
					y = 0;
				for (var e = elt; e != null; e = e.offsetParent) {
					x += e.offsetLeft;
					y += e.offsetTop;
				}
				for (var e = elt.parentNode; e != null && e.nodeType == 1; e = e.parentNode) {
					x -= e.scrollLeft;
					y -= e.scrollTop;
				}
				return {
					x: x,
					y: y
				};
			};
			var offPos=function (e,end) {//e离offsetParent 元素的距离 
				var x, y,oCoord=oPos(QS('.pz-box'));
				if(end){
					x = parseInt(e.changedTouches[0].clientX-oCoord.x);
					y = parseInt(e.changedTouches[0].clientY-oCoord.y);
				}else{
					x = parseInt(e.touches[0].clientX-oCoord.x);
					y = parseInt(e.touches[0].clientY-oCoord.y);
				}
				return {
					x: x,
					y: y
				};
			};
			var stopDoc=function(e){
				e.preventDefault();
			};
			var docAddEvent=function(){
				document.addEventListener('touchmove',stopDoc,false);
			};
			var docRemoveEvent=function(){
				document.removeEventListener('touchmove',stopDoc,false);
			};
			
			var ratio=doc.getElementsByTagName('body')[0].offsetWidth/750;
			var initStyle=function(){
				var aEles=QSA('.pz-set-css');
				for(var i=0; i<aEles.length; i++){
					aEles[i].style.height=aEles[i].offsetHeight*ratio+'px';
					aEles[i].style.width=aEles[i].offsetWidth*ratio+'px';
					if(!aEles[i].classList.contains('pz-box')){
						aEles[i].style.top=aEles[i].offsetTop*ratio+'px';
						aEles[i].style.left=aEles[i].offsetLeft*ratio+'px';
					}
				}
			};
			initStyle();
			
			var aTarget=[],zIndex=11;//全局变量，目标点和最前
			var initTarget=function(){
				var target_w=60*ratio,target_h=114*ratio;//目标的区域的宽高
				var target_init_x1=233*ratio,target_init_y1=272*ratio;
				var target_init_x3=target_init_x2=114*ratio;
				for(var i=0; i<7; i++){
					var j;
					if(i==0){
						j="({'x':"+target_init_x1+",'y':"+target_init_y1+"})";
					}else if(1<=i&&i<=3){
						j="({'x':"+(target_init_x2+target_w*(i-1))+",'y':"+(target_init_y1+target_h)+"})";
					}else{
						j="({'x':"+(target_init_x3+target_w*(i-4))+",'y':"+(target_init_y1+target_h*2)+"})";
					}
					aTarget.push(eval(j));
				}
			};
			initTarget();
			
			var _aTarget=[];
			for(var i=0; i<aTarget.length; i++){//备份
				_aTarget[i]=aTarget[i];
			}
			
			var limit_x=QS('.pz-box').offsetWidth,limit_y=QS('.pz-box').offsetHeight;
			
			function Item(ele){
				var start_x,start_y,detal_x,detal_y,_this=this;
				
				if(typeof ele=='string'){
					this.ele=QS(ele);
				}else{
					this.ele=ele;
				}
				
				this.ele.addEventListener('touchstart',function(e){
					docAddEvent();
					this.style.zIndex=++zIndex;
					start_x=offPos(e).x;
					start_y=offPos(e).y;
					detal_x=start_x-this.offsetLeft;
					detal_y=start_y-this.offsetTop;
					if(this.arrive==true){
						for(var i=0; i<this.arriveCoord.length;i++){
							aTarget[this.arriveCoord[i]]=_this._aTarget[this.arriveCoord[i]];
						}
						this.arriveCoord=[];
						this.arrive=false;
					}
					new Item(creatItem(this.which,this.dataset.size,this.oldLeft,this.oldTop));
				},false);
				
				this.ele.addEventListener('touchmove',function(e){
					var oCoord=offPos(e),now_x=oCoord.x-detal_x,now_y=oCoord.y-detal_y;
					this.style.left=now_x+'px';
					this.style.top=now_y+'px';
					if(now_x<=0){
						this.style.left=0;
					}
					if(now_y<=0){
						this.style.top=0;
					}
					if(now_x>=limit_x-this.offsetWidth){
						this.style.left=limit_x-this.offsetWidth+'px';
					}
					if(now_y>=limit_y-this.offsetWidth){
						this.style.top=limit_y-this.offsetHeight+'px';
					}
				},false);
				
				this.ele.addEventListener('touchend',function(e){
					var oCoord=offPos(e,true),now_x=oCoord.x-detal_x,now_y=oCoord.y-detal_y;
					for(var i=0; i<aTarget.length; i++){
						if(aTarget[i]!=null&&now_x<=aTarget[i].x+25&&now_y<=aTarget[i].y+25){
							if(this.dataset.size=='宽1'){
								_this._park(i);
								_this.arriveTarget(i);
								return;
							}else if(this.dataset.size=='宽2'){
								if(i!=0&&i!=3&&i!=6){
									if(aTarget[i+1]!=null){
										_this._park(i);
										_this.arriveTarget(i);
										_this.arriveTarget(i+1);
										return;
									}
								}
							}else if(this.dataset.size=='宽3'){
								if((i==1||i==4)&&(aTarget[i+1]!=null&&aTarget[i+2]!=null)){
									_this._park(i);
									_this.arriveTarget(i);
									_this.arriveTarget(i+1);
									_this.arriveTarget(i+2);
									return;
								}
							}else if(this.dataset.size=='长2'){
								if(0<=i<=3){
									if(aTarget[i+3]!=null){
										_this._park(i);
										_this.arriveTarget(i);
										_this.arriveTarget(i+3);
										return;
									}
								}
							}
						}
					}
					_this._back();
				},false);
				this.arriveTarget=function(i){
					if(!this.ele.arriveCoord){
						this.ele.arriveCoord=[];
					}
					this.ele.arrive=true;//入座
					this.ele.arriveCoord.push(i);
					aTarget[i]=null;
				}
			}
			Item.prototype._aTarget=_aTarget;//保存原始目标坐标
			Item.prototype._park=function(i){
				this.ele.style.left=aTarget[i].x+'px';
				this.ele.style.top=aTarget[i].y+'px';
			};
			Item.prototype._back=function(){
				var _this=this
				this.ele.classList.add('pz-ani');
				this.ele.style.left=this.ele.oldLeft+'px';
				this.ele.style.top=this.ele.oldTop+'px';
				setTimeout(function(){
					_this.ele.parentNode.removeChild(_this.ele);
				},300);
				
				
				
			};
			
			function creatItem(sel,size,x,y){
				var o=doc.createElement('div');
				var html="<div class='"+sel+" pz-set-css pz-items' data-size='"+size+"'></div>";
				var oItem=null;
				o.innerHTML=html;
				oItem=o.children[0];
				QS('.pz-box').appendChild(oItem);
				oItem.style.height=oItem.offsetHeight*ratio+'px';
				oItem.style.width=oItem.offsetWidth*ratio+'px';
				oItem.style.left=x+'px';
				oItem.style.top=y+'px';
				oItem.oldLeft=x;
				oItem.oldTop=y;
				oItem.which=sel;
				return oItem;
			}
			
			var allBtn=QSA('.pz-p');
			for(var i=0; i<allBtn.length; i++){
				var size=['宽1','宽2','宽3','长2'][i];
				var newer=creatItem('pz-item'+(i+1),size,allBtn[i].offsetLeft,allBtn[i].offsetTop);
				new Item(newer);
			}
			
			doc.addEventListener('touchend',function(e){
				docRemoveEvent();
			},false);
			
			function getRusult(){
				var allItems=QSA('.pz-items'),temp=[],result={};
				for(var i=0; i<allItems.length; i++){
					if(allItems[i].arrive){
						temp.push(allItems[i]);
					}
				}
				for(var i=0; i<_aTarget.length; i++){
					if(_aTarget[i]!=null){
						for(var j=0; j<temp.length; j++){
							if(Math.abs(_aTarget[i].x-temp[j].offsetLeft)<=1&&Math.abs(_aTarget[i].y-temp[j].offsetTop)<=1){
								var atr=temp[j].dataset.size;
								result['第'+i+'位']=(atr=='宽1'&&'单人')||(atr=='宽2'&&'双人')||(atr=='宽3'&&'三人')||(atr=='长2'&&'加长');
								continue;
							}
						}
					}
				}
				return result;//最终返回数据形式为json{第0位: "加长", 第1位: "单人", 第2位: "单人", 第4位: "三人"}
			}
			
			QS('#debug').onclick=function(){//测试用，点击事件，请按实际需求调整
				var param=getRusult();
				/* $.ajax({
				 url: url,
				 data: param,
				})*/
				alert(JSON.stringify(param));
			}
			
		})(document);
	</script>
</body>
</html>